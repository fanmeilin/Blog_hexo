---
title: 精读Adaptive Consistency Prior based Deep Network for Image Denoising
tags: [文献,阅读方法]
categories: [文献,阅读方法]
date: 2022-02-14 18:22:22
---

> 这是一篇2021年发表在cvpr期刊上的文章，老师说可以多关注他的加噪方式和文章的实验对比方法，正好以此为例，来精读此文章以作讲解。
>
> 灰常nice！ 阅读pdf文章的网站https://readpaper.com/

### 第一遍

**重点：标题-> 摘要 -> 结论的顺序； 目的是大概了解文章，做出取舍；**

**tips：可以大概看看图表，了解关键的方法。**

#### 预览

1. 标题：Adaptive Consistency Prior based Deep Network for Image Denoising

    ​			基于自适应一致性先验的深度网络图像去噪

2. 摘要：

    **总结** :作者提出了ACP+Deam 可以在合成噪声和真实噪声的图片降噪上取得好的结果。

    **问题现状**：如何将传统方法融入到网络设计中同时提高可解释性，仍然是一个悬而未决的问题。

    **方法** :提出了一种新的基于模型的去噪方法来指导去噪网络的设计，首先，通过在传统的一致性先验中引入非线性滤波算子、可靠性矩阵和高维特征变换函数，提出了一种新的自适应一致性先验(ACP)。其次，通过将ACP项引入最大后验框架，提出了一种基于模型的去噪方法，并将该方法用于指导网络设计，得到了一种新的端到端可训练、可解释的深度去噪网络。

3. 结论：

    **总结** :提出了Deamnet深度网络来图像去噪。

    **创新点** :与现有的大多数深度网络去噪方法不同，我们将新的ACP项（传统方法）引入到优化问题中，然后利用unfolding策略利用优化过程来指导深度网络的设计。

    **成果** :在一定程度上提高了可解释性。实验结果表明，该网络具有领先的去噪性能。

4. 其他

    查看他的图表可以发现他的工作非常的详细，对各种网络，各种数据集进行了各种效果的对比，从图像，数据集，噪声强度，PSNR，SSIM，运行时间，参数大小各个方面进行对比，值得学习。

#### 思路

文章的思路：**将传统的降噪方法和深度学习网络结合**

- 在传统的一致性先验中引入非线性滤波算子、可靠性矩阵和高维特征变换函数，提出了一种新的自适应一致性先验(ACP)
- 通过将ACP项引入最大后验框架，提出了一种基于模型的去噪方法，并将该方法用于指导网络设计，得到去噪网络。

#### 思考

关注点：思考噪声是怎么加的，用了哪几种噪声？

### 第二遍

**重点：从头到尾读，不用关注得太细节，主要目的是清晰了解图表含义。**

**tips：圈出感兴趣的文献。**

#### Introduce

如果对这个领域不是非常了解，就可以好好看看Introduce中的内容，一般会对该领域研究问题进行总结和梳理。可以标记出感兴趣的文献。

在Introduce中提出的几种去噪方法，对这三种方法的含义和相关算法简要介绍：

- filtering-based methods

  - 原理：由于图像中有很多相似物，可以使用非局部相似块来去除噪声，比如NLM和BM3D，各种非局部滤波方法应运而生。

  - 问题：输出模糊，去噪方法中的超参数难以调整。

- model-based methods

  - 原理：基于模型的方法通常将去噪任务描述为基于后验I(MAP)的最大优化问题，其性能主要取决于图像先验。

  - 前提：在假设图像块可以用适当的基函数稀疏表示的前提下。

  - 方法：提出稀疏先验，最近，提出了一种基于三边加权稀疏编码的真实图像去噪方法。根据自然图像中非局部相似块构成的矩阵具有低秩的特点，提出了很多基于低秩先验的图像去噪方法，还有IR的加权核范数最小化(WNNM)方法。此外还有图的正则化方法。
  - 好处：基于模型的方法具有很强的数学推导能力。
  - 问题：1，在恢复强噪声下的纹理结构时，性能会明显下降。2，由于迭代优化的高度复杂性，它们通常很耗时。

- learning-based methods
  - 定义：基于学习的方法侧重于从噪声图像到干净图像的潜在映射学习，可分为传统的基于学习的方法和基于深度网络的方法。
  - 评价：由于基于深度网络的去噪方法比基于滤波、基于模型和基于传统学习的方法取得了更好的去噪效果，它们已成为**主流**的去噪方法。
  - 问题：大多数深度网络方法的体系结构都是经验性设计的，没有充分考虑传统算法的成果，在一定程度上面临着可解释性较弱的问题。
- 最近，也有人提出了用深度网络展开来实现一些传统的方法。

作者主要工作是提出一种新的基于模型的去噪方法，并深入研究该方法的推理过程，为其去噪CNN(DeamNet)的设计提供参考。

> 这里我对作者提出的方法有一些疑问，基于模型和基于学习的去噪方法的本质区别在哪里，作者的工作”去噪的CNN设计提供参考“涉及到卷积神经网络，为什么还是基于模型的去噪方法呢？
>
> 在 Proposed Method部分作者阐述了自己的设计思想，这一部分涉及的公式很多，其实对作者所提出的方法和我自身的研究内容不是非常的契合，所以这部分可以简要看看，我主要的目的还是对它的实验中噪声和数据部分更加感兴趣。

#### 设计思想

- Adaptive Consistency Prior for Denoising 
  - 自适应一致性先验算法在去噪中的应用,本文提出了一种端到端的可训练展开网络，该网络能够自适应地学习这些算子。

- Deep Unfolding Denoising Network
  - DeamNet的体系结构。它由特征域(FD)模块、重构模块、基于非线性运算(NLO)子网络的K个迭代阶段和双元素注意机制(DEAM)模块组成.
  - 在高维FD中进行去噪具有以下优点：1)可以将原始的噪声空间潜在地变换到FD空间，在FD空间中可以更容易地降低噪声，从而获得比像素域更精细的图像细节。“补充材料”中的实验详细说明了这一点；2）使用高维FD模块还可以增加特征通道数并且增强神经网络中的信息流传输来得到更高的性能。相比之下，传统的深度展开网络在低维图像空间进行迭代去噪；3)通过将地面真实图像与退化图像之间的残差视为待降噪的部分，该策略还可以使网络更适用于其他红外应用。
  - 在传统的注意机制中，低频分支的重要性在很大程度上被忽视了。相反，如果低频分支对潜在特征的描述不理想，则DEAM可以自适应地增加残留分支的特征权重，反之亦然。此外，DEAM中的初始特征信息可用性和跨层特征交互可以进一步增强网络的表达能力。

#### 实验部分

分为对合成噪声数据集和真实数据集上去噪两个模块。

**噪声类型**： 加性高斯白噪声AWGN(Additive White Gaussian Noise)  （在论文中提到的强度对比 15, 25 and 50.）

- 训练部分

```python
parser.add_argument("--noiseL", type=float, default=25, help='noise level')
def train(epoch):
    epoch_loss = 0
    model.train()
    for iteration, batch in enumerate(training_data_loader, 1):
        target = Variable(batch)
        noise = torch.FloatTensor(target.size()).normal_(mean=0, std=opt.val_noiseL / 255.)
        input = target + noise
        .....
```

- 测试部分（合成）

```python
parser.add_argument("--test_noiseL", type=float, default=15, help='noise level used on test set') #噪声强度
opt = parser.parse_args()

ISource = torch.Tensor(Img)    
# noise
noise = torch.FloatTensor(ISource.size()).normal_(mean=0, std=opt.test_noiseL / 255.) #高斯噪声
# noisy image
INoisy = ISource + noise #加性
ISource, INoisy = Variable(ISource.cuda()), Variable(INoisy.cuda())
```

真实数据集

```python
    def __getitem__(self, index):
        clean = Image.open(self.path[index])

        if self.transform:
            clean = self.transform(clean)

        noise = torch.randn(clean.size()).mul_(self.sigma/255.0) #噪声？
        noisy = clean + noise
        noisy = torch.clamp(noisy, 0.0, 1.0)
        return noisy, clean
```

> 这里加噪代码存疑
>
> 论文中对真实数据集的去噪细节中写道：
>
> 由于真实噪声通常是信号相关的，并且随着摄像机内管线的不同，真实图像去噪通常是一项极具挑战性的任务，为了进一步展示DeamNet对真实噪声的泛化能力，选择DND基准、SIDD基准和RNI15数据集作为测试数据集。请注意，对于DND和SIDD基准，几乎无噪音的图像不是公开的，但PSNR/SSIM结果可以通过他们的在线服务器获得。而对于RNI15，只有噪声图像可用。

#### 合成噪声数据集（重点关注）

**训练数据集**包括：

1. the Berke-ley Segmentation Dataset (BSD)  是为图像分割和边界检测的研究提供经验基础的数据集，包含来自 30 个人类受试者的 1000 个手工标记的 1000 个 Corel 数据集图像的分割，其中一半的分割是通过向主体呈现彩色图像而获得的; 另一半来自呈现灰度图像。

2. Div2K：数据集有1000张高清图(2K分辨率)，其中800张作为训练，100张作为验证，100 张作为测试。

三个标准**基线数据集**进行了评估 （指标：PSNR and SSIM）

1. Set12：数字图像处理常用数据集Set12，12张灰度图（含lena，cameraman，house，pepper，fishstar，monarch，airplane，parrot，barbara，ship，man，couple），01-07是256\*256,08-12是512\*512.

2. BSD68  数字图像处理常用数据集BSD68，68张灰度图，大小不一。

3. Urban100  ：一个用于超分辨率和图像重建的数据集 Urban100，总计100张建筑高清图片，同时对应了100张降低分辨率的图片。

#### 真实噪声数据集

##### 训练数据集

1. SIDD：智能手机图像去噪数据集（SIDD）使用5个具有代表性的智能手机摄像头，从10个场景中提取约30000个噪声图像，并生成它们真实的场景图像。
2. RENOIR：一个真实的图像降噪数据集，包含了3个子数据集，分别是Xiaomi Mi3，Canon S90，Canon T3i拍摄，拥有低噪和高噪对比图。

##### 测试数据集

- DND：是由50幅真实世界的噪声图像组成的，但没有几乎没有噪声的对应图像。通常，可以通过将去噪图像上传到DND网站来获得PSNR/SSIM结果。

- SIDD：提供320对噪声图像和近无噪声图像用于训练，1280个图像patch用于验证。PSNR/SSIM结果可以通过将去噪图像提交到SIDD网站获得。

- RNI15：提供了15幅真实噪声图像。不幸的是，地面真实的干净图像不可用，因此我们只展示RNI15的视觉结果。

#### 数据增强

我们将这些训练图像对随机裁剪成大小为128×128的小块。为了增加训练样本，采用了180度的旋转和水平翻转。

#### 对比网络

- TNRD

- DnCNN

- FFDNet

- RED 

- MemNet 

- UNLNet

- CFSNet

- N3Net 

- ADNet 

- BRDNet

- RIDNet

##### 合成数据集效果

![](https://picture.mulindya.com/deamnet1.png)

##### 真实数据集效果

![](https://picture.mulindya.com/deamnet2.png)

### 第三遍

**重点：详细了解文章，并且拓展到自己，给自己设置问题，学会“脑补”**。

**tips: 在文章最后作者会提到文章有一些没有继续研究的地方，可以记录自己的思考。**

